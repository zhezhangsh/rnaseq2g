names(ln) <- names(ids)[1:28]
ln
for (i in 1:length(ln)) names(ln[[i]]) <- names(ids)[(i+1):29]
ln
unlist(ln)
unlist(ln)->x
summary(ln)
ln
x <- unlist(ln)
x
summary(n)
summary(x)
length(x[x==0])
names(x[x==0])
DeMethodMeta['DeAldex2', ]
names(ids)
x <- unlist(ln[-23])
summary(x)
min(x)
sort(x)[1:2]
x <- unlist(ln)
x <- x[-grep('DeAldex2', names(x))]
summary(x)
sort(x)[1:2]
sort(x)[1:10]
x <- x[-grep('DeTweeDeSeq', names(x))]
summary(x)
sort(x)[1:10]
DeMethodMeta['DeAbsSeq', ]
mean(x)
max(x)
rev(sort(x))[1:10]
dim(rnk)
plot(rnk[, 'DeLimma'], rnk[, 'RBM'])
plot(rnk[, 'DeLimma'], rnk[, 'DeRBM'])
cor(rnk[, 'DeLimma'], rnk[, 'DeRBM'])
DeMethodMeta['DeRBM', ]
DeMethodMeta['DeLimma', ]
args(DeRBM)
sort(x)[1:10]
rev(sort(x))[1:10]
hr(),
column(
12,
div(style="display: inline-block;", textInput('analysis.send.email', label=NULL, width='200px')),
div(style="display: inline-block;", HTML("&nbsp&nbsp&nbsp")),
div(style="display: inline-block;",
HTML("<font size='3'>Send a notice to this email address after the analysis is done (optional).</font>"))
)
runApp('/srv/shiny-server/rnaseq_2g')
runApp('/srv/shiny-server/rnaseq_2g')
runApp('/srv/shiny-server/rnaseq_2g')
runApp('/srv/shiny-server/rnaseq_2g')
q()
setwd("/srv/shiny-server/rnaseq_2g_dev")
shiny::runApp()
runApp()
runApp()
# Pre-load packages and data when this App is started
.libPaths("/home/zhangz/R/x86_64-pc-linux-gnu-library/3.3");
APP_HOME<-"/srv/shiny-server/rnaseq_2g_dev";
require(XML);
require(readxl);
require(shinythemes);
require(RoCA);
require(rchive);
require(awsomics);
require(DEGandMore);
# Loading housekeeping data and custom function
fn  <- paste(APP_HOME, 'source', dir(paste(APP_HOME, 'source', sep='/')), sep='/');
fnc <- sapply(fn, function(fn) if (gregexpr('\\.R$', fn, ignore.case=TRUE)>0) source(fn));
ncls <- 2;
count_example <- readRDS(paste(APP_HOME, 'data/count_example.rds', sep='/'));
group_example <- list(Control=colnames(count_example)[1:3], Patient=colnames(count_example)[4:6]);
data(DeMethodMeta);
DeRNAseqMs    <- DeMethodMeta;
method.group  <- c('None', 'Default', 'Fast', 'Fast + Medium', 'Fast + Mediumn + Slow', 'All');
norm.count    <- as.character(as.list(args(DeRNAseq))$norm.count)[-1];
norm.logged   <- as.character(as.list(args(DeRNAseq))$norm.logged)[-1];
plot.type     <- list('Pvalue'=1, 'FDR'=2, 'Volcano'=3, 'M-A'=4);
button.style  <- "font-family: Courier New; color: #fff; background-color: tomato; border-color: black";
choices.pv    <- list('1' = 1, '0.5' = 0.5, '0.25' = 0.25, '0.10' = 0.1, '0.05' = 0.05, '0.01' = 0.01, '0.001' = 0.001);
choices.fc    <- list('None' = 0, '5%' = log2(1.05), '10%' = log2(1.1), '25%' = log2(1.25), '50%' = log2(1.5), '100%' = 1,
'200%' = log2(3), '400%' = 2, '800%' = 3);
##########################################################################################################
# datatable options
dt.options1 <- list(
dom = 't', scrollX = TRUE,
initComplete = DT::JS("function(settings, json) {",
"$(this.api().table().header()).css({'background-color': '#666', 'color': '#fff'});",
"}"));
dt.options2 <- list(
dom = 't', scrollX = FALSE, pageLength = 100,
initComplete = DT::JS("function(settings, json) {",
"$(this.api().table().header()).css({'background-color': '#666', 'color': '#fff'});",
"}"));
dt.options3 <- list(
scrollX = TRUE, pageLength = 12,
initComplete = DT::JS("function(settings, json) {",
"$(this.api().table().header()).css({'background-color': '#666', 'color': '#fff'});",
"}"));
dt.options4 <- list(
dom = 't', scrollX = TRUE, pageLength = 100,
initComplete = DT::JS("function(settings, json) {",
"$(this.api().table().header()).css({'background-color': '#666', 'color': '#fff'});",
"}"));
runApp()
runApp()
setwd("/srv/shiny-server/rnaseq_2g_dev")
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
x <- system.time(a <- DeRNAseq(ct, grps, mthds='DeNBPSeq', min.count = 6)[[2]][[1]]
install_github('zhezhangsh/DEGandMore')
DeBaySeq
x <- system.time(a <- DeRNAseq(ct, grps, mthds='DeBaySeq', min.count = 6)[[2]][[1]]
dim(ct)
dim(ct)
dir()
setwd('~')
dir()
setwd('project/')
dir()
setwd('2016-10_BrainTumors/')
dir()
ct <- readRDS('count.rds')
grps <- split(colnames(ct), substr(colnames(ct), 1, 2))
grps
x <- system.time(a <- DeRNAseq(ct, grps, mthds='DeBaySeq', min.count = 6)[[2]][[1]])
x <- system.time(a <- DeRNAseq(ct[1:100, ], grps, mthds='DeBaySeq', min.count = 6)[[2]][[1]])
x <- DeBaySeq(ct[1:100, ], grps, cl=1)
x <- system.time(a <- DeRNAseq(ct[1:100, ], grps, mthds='DeBaySeq', min.count = 6)[[2]][[1]])
x <- DeBaySeq(ct[1:100, ], grps, cl=1)
install_github('zhezhangsh/DEGandMore')
x <- system.time(a <- DeRNAseq(ct[1:100, ], grps, mthds='DeBaySeq', min.count = 6)[[2]][[1]])
x
10*2500
x <- system.time(a <- DeRNAseq(ct[1:1000, ], grps, mthds='DeBaySeq', min.count = 6)[[2]][[1]])
x
100*180
10*180
x <- system.time(a <- DeRNAseq(ct, grps, mthds='DeBaySeq', min.count = 6)[[2]][[1]])
x
names(stat)
stat <- readRDS('stat.rds')
b <- stat$DeBaySeq
dim(b)
dim(a)
plot(a[, 5], b[, 5])
hist(a[, 5], br=100)
hist(b[, 5], br=100)
hist(a[, 5], br=100)
head(a)
head(b)
stat$DeBaySeq <- a
saveRDS(stat, 'stat.rds')
runApp('/srv/shiny-server/rnaseq_2g')
runApp('/srv/shiny-server/rnaseq_2g')
install_github('zhezhangsh/DEGandMore')
install_github('zhezhangsh/DEGandMore')
args(DeTSPM)
detach("package:DEGandMore", unload=TRUE)
library("DEGandMore", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.3")
install_github('zhezhangsh/DEGandMore')
detach("package:DEGandMore", unload=TRUE)
library("DEGandMore", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.3")
x <- system.time(a <- DeRNAseq(ct, grps, mthds='DeTSPM', min.count = 6)[[2]][[1]])
install_github('zhezhangsh/DEGandMore')
detach("package:DEGandMore", unload=TRUE)
detach("package:DEGandMore", unload=TRUE)
install_github('zhezhangsh/DEGandMore')
x <- system.time(a <- DeRNAseq(ct, grps, mthds='DeTSPM', min.count = 6)[[2]][[1]])
library("DEGandMore", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.3")
x <- system.time(a <- DeRNAseq(ct, grps, mthds='DeTSPM', min.count = 6)[[2]][[1]])
DeMethods()
DeRNAseqMethods()
x <- system.time(a <- DeTSPM(ct, grps))
x
length(s)
length(stat)
dim(p)
p <- sapply(stat, function(x) x[, 5])
dim(p)
a <- a[rownames(p), ]
dim(a)
head(a)
a <- a[[1]]
hist(a[, 5], br=100)
dim(a)
a <- a[rownames(p), ]
dim(a)
r <- cor(a[, 5], p)
r <- cor(a[, 5], p, method='spearman')
r
sort(r)
r <- as.vector(r)
r
names(r) <- names(stat)
sort(r)
DeMethodMeta['DeLMGene', ]
install_github('zhezhangsh/DEGandMore')
data("DeMethodMeta")
dim(DeMethodMeta)
DeMethodMeta[,1:7]
table(DeMethodMeta[, 7])
rownames(DeMethodMeta)
sort(rownames(DeMethodMeta))
install.packages(c("sp","pixmap", "snowfall", "VGAM", "mclust", "logcondens", "Iso","XML","rgl"));
source("http://www.math.ntnu.no/inla/givemeINLA.R");
install.packages(c("sp", "pixmap", "snowfall", "VGAM", "mclust",
install.packages(c("sp","pixmap", "snowfall", "VGAM", "mclust", "logcondens", "Iso","XML","rgl"));
install.packages(X11)
install.packages('X11')
source("http://www.math.ntnu.no/inla/givemeINLA.R");
library(rgl)
q()
install.packages('rgl')
q()
install.packages('rgl')
library(rgl)
library("devtools"); install_github("markvdwiel/ShrinkBayes")
q()
library("devtools"); install_github("markvdwiel/ShrinkBayes")
q()
library("devtools"); install_github("markvdwiel/ShrinkBayes")
q()
library("devtools"); install_github("markvdwiel/ShrinkBayes")
library(devtools)
install_local('~/project/2016-10_BrainTumors/ShrinkBayes/')
?exportPattern
setwd("~/project/2016-10_BrainTumors/ShrinkBayes/R")
setwd("~/project/2016-10_BrainTumors")
install_local('ShrinkBayes/')
dir('ShrinkBayes/', rec=TRUE)->f
length(f)
f
lns <- lapply(f, readLines)
setwd('ShrinkBayes/')
lns <- lapply(f, readLines)
lns[[1]]
lns[[2]]
lns <- lapply(lns, function(x) x[grep('rgl'), x])
lns <- lapply(lns, function(x) x[grep('rgl', x)])
lns[[1]]
names(lns) <- f
n <- sapply(lns, length)
n
table(n)
f[n>0]
library(rgl)
library(logcondens)
install.packages('logcondens')
library(logcondens)
library(Iso)
install_local('ShrinkBayes/')
setwd('..')
install_local('ShrinkBayes/')
library(ShrinkBayes)
setwd('ShrinkBayes/')
lns <- lapply(f, readLines)
lns <- lapply(lns, function(x) x[grep('logcondens', x)])
n <- sapply(lns, length)
table(n)
f[n>0]
install.packages('logcondens')
install.packages("logcondens")
lns <- lapply(lns, function(x) x[grep('logcondens', x)])
lns <- lapply(lns, function(x) x[grep('NonParaUpdatePrior', x)])
n <- sapply(lns, length)
f[n>0]
q()
setwd("~/project/2016-10_BrainTumors")
library(ShrinkBayes)
library(ShrinkBayes)
data(CAGEdata10000)
CAGEdata <- CAGEdata10000
CAGEdata <- CAGEdata[1:1000,]
data(design_brain)
design_brain
pers <- design_brain$pers  #persons
batch <-design_brain$batch   #batch
groupfac <- design_brain$groupfac #group (= brain region)
ncpus2use <- 10
groupfac <- BaselineDef("groupfac",baselinegroup="1")
lincombvec <- AllComp("groupfac")
form = y ~ 1 + groupfac + batch + f(pers,model="iid")
shrinksimul <- ShrinkSeq(form=form, dat=CAGEdata,shrinkfixed="groupfac", shrinkrandom="pers",mixtdisp=TRUE,ncpus=ncpus2use)
shrinksimul <- ShrinkSeq(form=form, dat=CAGEdata[1:20, ],shrinkfixed="groupfac", shrinkrandom="pers",mixtdisp=TRUE,ncpus=ncpus2use)
str(shrinksimul)
data(De)
library(DEGandMore)
data(De)
prepared <- PrepareDe(mtrx, grps, paired);
mtrx     <- prepared[[1]];
grps     <- prepared[[2]];
paired   <- prepared[[3]];
e <- log2(mtrx+1)
prepared <- PrepareDe(mtrx, grps, paired);
mtrx     <- prepared[[1]];
grps     <- prepared[[2]];
paired   <- prepared[[3]];
n   <- sapply(grps, length);
des <- factor(rep(1:2, n));
frm <- ~ 1 +  des;
res <- ShrinkBayesWrap(dat=e[1:10, ], form=frm, ncpus2use = 2);
inla.expectation
library(INLA)
data(inla.expectation)
source("http://www.math.ntnu.no/inla/givemeINLA.R")
inla.upgrade()
q()
library(INLA)
data(inla.upgrade())
library(DEGandMore)
data(De)
require(DEGandMore);
require(ShrinkBayes);
prepared <- PrepareDe(mtrx, grps, paired);
mtrx     <- prepared[[1]];
grps     <- prepared[[2]];
paired   <- prepared[[3]];
n   <- sapply(grps, length);
des <- factor(rep(1:2, n));
frm <- ~ 1 +  des;
res <- ShrinkBayesWrap(dat=e[1:100, ], form=frm, ncpus2use = 2);
e <- log2(mtrx+1)
des <- factor(rep(1:2, n));
frm <- ~ 1 +  des;
res <- ShrinkBayesWrap(dat=e[1:100, ], form=frm, ncpus2use = 2);
data(inla.expectation)
des <- factor(rep(1:2, n));
frm <- ~ 1 +  des;
res <- ShrinkBayesWrap(dat=e[1:100, ], form=frm, ncpus2use = 2, approx0=TRUE);
des <- factor(rep(1:2, n));
frm <- ~ 1 +  des;
res <- ShrinkBayesWrap(dat=mtrx[1:100, ], form=frm, ncpus2use = 2);
des <- factor(rep(1:2, n));
frm <- ~ 1 +  des;
res <- ShrinkBayesWrap(dat=mtrx[1:10, ], form=frm, ncpus2use = 2);
des <- factor(rep(1:2, n));
frm <- ~ 1 +  des;
res <- ShrinkBayesWrap(dat=mtrx[1:10, ], form=frm, ncpus2use = 2, fam='zip');
des <- factor(rep(1:2, n));
frm <- ~ 1 +  des;
res <- ShrinkBayesWrap(dat=mtrx[1:10, ], form=frm, ncpus2use = 2, fam='zinb');
des <- factor(rep(1:2, n));
frm <- ~ 1 +  des;
system.time(res <- ShrinkBayesWrap(dat=mtrx[1:10, ], form=frm, ncpus2use = 2, fam='zinb'))
4*20000
4*20000/3600
des <- factor(rep(1:2, n));
frm <- ~ 1 +  des;
system.time(res <- ShrinkBayesWrap(dat=mtrx[1:10, ], form=frm, ncpus2use = 10, fam='zinb'))
library(ShrinkBayes)
data(CAGEdata10000)
CAGEdata <- CAGEdata10000
CAGEdata <- CAGEdata[1:1000,]
CAGEdata[1:2,]
data(design_brain)
design_brain
pers <- design_brain$pers  #persons
batch <-design_brain$batch   #batch
groupfac <- design_brain$groupfac #group (= brain region)
ncpus2use <- 10
groupfac <- BaselineDef("groupfac",baselinegroup="1")
lincombvec <- AllComp("groupfac")
form = y ~ 1 + groupfac + batch + f(pers,model="iid")
system.time(shrinksimul <- ShrinkSeq(form=form, dat=CAGEdata[1:10, ],shrinkfixed="groupfac", shrinkrandom="pers",mixtdisp=TRUE,ncpus=ncpus2use));
shrinksimul
str(shrinksimul)
data(De)
prepared <- PrepareDe(mtrx, grps, paired);
mtrx     <- prepared[[1]];
grps     <- prepared[[2]];
paired   <- prepared[[3]];
n   <- sapply(grps, length);
grp <- factor(rep(1:2), n);
grp <- BaselineDef("grp",baselinegroup="1")
per <- 1:sum(n);
frm <- y ~ 1 + grp + f(per, model='iid');
system.time(shrinksimul <- ShrinkSeq(form=frm, dat=mtrx[1:10, ],shrinkfixed="grp", shrinkrandom="per",mixtdisp=TRUE,ncpus=ncpus2use));
grp <- factor(rep(1:2), n);
n   <- sapply(grps, length);
grp <- factor(rep(1:2, n));
grp <- BaselineDef("grp",baselinegroup="1")
per <- 1:sum(n);
frm <- y ~ 1 + grp + f(per, model='iid');
system.time(shrinksimul <- ShrinkSeq(form=frm, dat=mtrx[1:10, ],shrinkfixed="grp", shrinkrandom="per",mixtdisp=TRUE,ncpus=ncpus2use));
system.time(shrinksimul <- ShrinkSeq(form=frm, dat=mtrx[1:10, ],shrinkfixed="grp", shrinkrandom="per",mixtdisp=TRUE,ncpus=2));
system.time(shrinksimul <- ShrinkSeq(form=frm, dat=mtrx[1:10, ],shrinkfixed="grp", shrinkrandom="per",mixtdisp=TRUE,ncpus=1));
system.time(suppressMessages(shrinksimul <- ShrinkSeq(form=frm, dat=mtrx[1:10, ],shrinkfixed="grp", shrinkrandom="per",mixtdisp=TRUE,ncpus=1)));
system.time(suppressMessages(shrinksimul <- ShrinkSeq(form=frm, dat=mtrx[1:10, ],shrinkfixed="grp", shrinkrandom="per",mixtdisp=TRUE,ncpus=1)));
system.time(suppressMessages(shrinksimul <- ShrinkSeq(form=frm, dat=mtrx[1:10, ],shrinkfixed="grp", mixtdisp=TRUE,ncpus=1)));
system.time(suppressMessages(shrinksimul <- ShrinkSeq(form=frm, dat=mtrx[1:10, ], mixtdisp=TRUE,ncpus=1)));
system.time(suppressMessages(shrinksimul <- ShrinkSeq(form=frm, dat=mtrx[1:10, ], mixtdisp=FALSE,ncpus=1)));
system.time(suppressMessages(shrinksimul <- ShrinkSeq(form=frm, dat=mtrx[1:10, ],shrinkfixed="grp", shrinkrandom="per",mixtdisp=FALSE,ncpus=1)));
system.time(suppressMessages(shrinksimul <- ShrinkSeq(form=frm, dat=mtrx[1:10, ],shrinkfixed="grp", shrinkrandom="per",mixtdisp=FALSE,ncpus=2)));
system.time(suppressMessages(shrinksimul <- ShrinkSeq(form=frm, dat=mtrx[1:10, ],shrinkfixed="grp", shrinkrandom="per",mixtdisp=FALSE,ncpus=1)));
system.time(suppressMessages(shrinksimul <- ShrinkSeq(form=frm, dat=mtrx[1:10, ],shrinkfixed="grp", shrinkrandom="per",mixtdisp=FALSE,ncpus=1)));
system.time(suppressMessages(shrinksimul <- ShrinkSeq(form=frm, dat=mtrx[1:10, ],shrinkfixed="grp", shrinkrandom="per",mixtdisp=TRUE,ncpus=1)));
args(ShrinkSeq)
system.time(suppressMessages(shrinksimul <- ShrinkSeq(form=frm, dat=mtrx[1:10, ],shrinkfixed="grp", shrinkrandom="per",mixtdisp=TRUE,ncpus=1, maxiter=5)));
system.time(suppressMessages(shrinksimul <- ShrinkSeq(form=frm, dat=mtrx[1:10, ],shrinkfixed="grp", shrinkrandom="per",mixtdisp=TRUE,ncpus=1, maxiter=3)));
system.time(suppressMessages(shrinksimul <- ShrinkSeq(form=frm, dat=mtrx[1:20, ],shrinkfixed="grp", shrinkrandom="per",mixtdisp=TRUE,ncpus=1, maxiter=3)));
system.time(suppressMessages(shrinksimul <- ShrinkSeq(form=frm, dat=mtrx[1:20, ],shrinkfixed="grp", shrinkrandom="per",mixtdisp=FALSE,ncpus=1, maxiter=3)));
shrinksimul$pmlist$mixp
str(shrinksimul)
prepared <- PrepareDe(mtrx, grps, paired);
mtrx     <- prepared[[1]];
grps     <- prepared[[2]];
paired   <- prepared[[3]];
n   <- sapply(grps, length);
grp <- factor(rep(1:2, n));
grp <- BaselineDef("grp",baselinegroup="1")
lin <- AllComp("grp")
per <- 1:sum(n);
frm <- y ~ 1 + grp + f(per, model='iid');
system.time(sim <- ShrinkSeq(form=frm, dat=mtrx[1:20, ],shrinkfixed="grp", shrinkrandom="per",mixtdisp=FALSE,ncpus=ncpus2use));
system.time(sim <- ShrinkSeq(form=frm, dat=mtrx[1:20, ],shrinkfixed="grp", shrinkrandom="per",mixtdisp=FALSE,maxiter=5, ncpus=ncpus2use));
system.time(sim <- ShrinkSeq(form=frm, dat=mtrx[1:20, ],shrinkfixed="grp", shrinkrandom="per",mixtdisp=FALSE,maxiter=5, ncpus=1));
system.time(fit <- FitAllShrink(frm,dat=mtrx[1:20, ],fams="zinb",sim,ncpus=1,lincomb=lin));
str(fit)
?FitAllShrink
?CombinePosteriors
system.time(fit2 <- FitAllShrink(frm,dat=mtrx[1:20, ],fams="zip",sim,ncpus=1,lincomb=lin));
cp <- CombinePosteriors(fit,fit2,sim,para="grp", ncpus=1)
cp
str(cp)
str(fit)
str(fit2)
fit$res
lin
lincombvec <- AllComp("grp")
grp
str(sim)
system.time(suppressMessages(sim <- ShrinkSeq(form=frm, dat=mtrx[1:100, ],shrinkfixed="grp", shrinkrandom="per",mixtdisp=TRUE,ncpus=1, maxiter=3)));
system.time(fit <- FitAllShrink(frm,dat=mtrx[1:100, ],fams="zinb",sim,ncpus=1,lincomb=lin));
system.time(fit <- FitAllShrink(frm,dat=mtrx[1:100, ],fams="zinb",sim,ncpus=1,lincomb=lin, verbose=TRUE));
system.time(fit <- FitAllShrink(frm,dat=mtrx[1:100, ],fams="zip",sim,ncpus=1,lincomb=lin, verbose=TRUE));
system.time(suppressMessages(sim <- ShrinkSeq(form=frm, dat=mtrx[1:20, ],shrinkfixed="grp", shrinkrandom="per",mixtdisp=FALSE,ncpus=1, maxiter=15)));
system.time(fit <- FitAllShrink(frm,dat=mtrx[1:20, ],fams="zinb",sim,ncpus=1,lincomb=lin, verbose=TRUE));
library(ShrinkBayes)
data(CAGEdata10000)
CAGEdata <- CAGEdata10000
CAGEdata <- CAGEdata[1:1000,]
CAGEdata[1:2,]
data(design_brain)
design_brain
pers <- design_brain$pers  #persons
batch <-design_brain$batch   #batch
groupfac <- design_brain$groupfac #group (= brain region)
ncpus2use <- 10
groupfac <- BaselineDef("groupfac",baselinegroup="1")
lincombvec <- AllComp("groupfac")
form = y ~ 1 + groupfac + batch + f(pers,model="iid")
system.time(sim <- ShrinkSeq(form=form, dat=CAGEdata[1:20, ],shrinkfixed="groupfac", shrinkrandom="pers",mixtdisp=FALSE,maxiter=5, ncpus=1));
system.time(fit <- FitAllShrink(from,dat=CAGEdata[1:20, ],fams="zinb",sim,ncpus=1,lincomb=lincombvec, verbose=F));
form = y ~ 1 + groupfac + batch + f(pers,model="iid")
system.time(fit <- FitAllShrink(form,dat=CAGEdata[1:20, ],fams="zinb",sim,ncpus=1,lincomb=lincombvec, verbose=F));
str(fit)
form = y ~ 1 + groupfac + batch + f(pers,model="iid")
lincombvec
lin
system.time(fit <- FitAllShrink(frm,dat=mtrx[1:20, ],fams="zinb",sim,ncpus=1, verbose=F));
str(fit)
system.time(fit <- FitAllShrink(frm,dat=mtrx[1:20, ],fams="zinb",sim,ncpus=1, lincombvec=lin));
system.time(fit <- FitAllShrink(frm,dat=mtrx[1:20, ],fams="zinb",sim,ncpus=1, lincombvec=lin));
system.time(fit <- FitAllShrink(frm,mtrx[1:20, ],fams="zinb",sim,ncpus=1));
names(fit)
names(fit[[1]])
length(fit[[1]])
fit[[1]][[1]]
fit[[1]][[1]]->x
names(x)
sort(names(x))
system.time(fit1 <- FitAllShrink(frm,mtrx[1:20, ],fams="zip",sim,ncpus=1));
npprior <- NonParaUpdatePrior(fitall=fit,modus="fixed", includeP0 = FALSE, shrinkpara="grp", shrinklc=TRUE,ncpus=1, maxiter = 3)
x <- CombinePosteriors(fit, fit1, sim)
x <- CombinePosteriors(fit, fit1, sim, 'grp', ncpus=1)
x
str(x)
length(x)
names(x)
names(x[[1]])
x[[1]][[1]]
x[[1]][[10]]
x[[1]][[10]]->y
colMeans(y)
y[[1]]
colMeans(y[[1]])
z <- sapply(x[[1]], function(x) colMeans(x[[1]]))
z
z <- t(z)
z
names9x
names(x)
length(x[[1]])
x[[2]]
pri <- MixtureUpdatePrior(fit)a
pri <- MixtureUpdatePrior(fit)
pri <- MixtureUpdatePrior(fit, shrinkpara='grp')
pri <- MixtureUpdatePrior(fit, shrinklc ='grp')
pri <- MixtureUpdatePrior(fit1, shrinklc ='grp')
devtools::install_github('zhezhangsh/DEGandMore')
devtools::install_github('zhezhangsh/DEGandMore')
devtools::install_github('zhezhangsh/DEGandMore')
devtools::install_github('zhezhangsh/DEGandMore')
DeT
q()
